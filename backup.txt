import cv2
import numpy as np


# Load the two images
image1 = cv2.imread('agh1_2.jpg', cv2.IMREAD_GRAYSCALE)  # Load the first image in grayscale
image1 = cv2.imread('agh1_1.jpg', cv2.IMREAD_GRAYSCALE)  # Load the second image in grayscale

# Resize image2 to match the dimensions of image1 if they differ
if image1.shape != image2.shape:
    image2 = cv2.resize(image2, (image1.shape[1], image1.shape[0]))

# Compute the absolute difference between the images
diff = cv2.absdiff(image1, image2)

# Apply a threshold to highlight significant differences
threshold_value = 30  # You can adjust this value
_, thresholded_diff = cv2.threshold(diff, threshold_value, 255, cv2.THRESH_BINARY)

# Resize the images for display
display_scale = 0.5  # Adjust this scale to resize the image display
resized_diff = cv2.resize(diff, (int(diff.shape[1] * display_scale), int(diff.shape[0] * display_scale)))
resized_thresholded_diff = cv2.resize(thresholded_diff, (int(thresholded_diff.shape[1] * display_scale), int(thresholded_diff.shape[0] * display_scale)))

# Calculate the threshold value (average intensity of the thresholded difference)
threshold_result = np.mean(thresholded_diff)

# Threshold Result
print(f"Threshold Result (Average Intensity): {threshold_result:.2f}")

# Display the images
cv2.imshow('Resized Difference Image', resized_diff)
cv2.imshow('Resized Thresholded Difference', resized_thresholded_diff)

# Save the thresholded difference image
cv2.imwrite('thresholded_difference.jpg', thresholded_diff)

# Wait for a key press and close the windows
cv2.waitKey(0)
cv2.destroyAllWindows()

# Return or print the threshold result
